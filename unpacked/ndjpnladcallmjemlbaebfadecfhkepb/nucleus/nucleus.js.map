{"version":3,"sources":["webpack://officechromeextension/./app/nucleus/nucleus.ts"],"names":["window","addEventListener","event","source","data","type","test","origin","messageData","chrome","runtime","sendMessage","activity","body","response","postMessage","undefined","sessionStorage","setItem","e"],"mappings":"mBAEA,IACEA,OAAOC,iBAAiB,WAAW,SAAUC,GAC3C,GAAKA,EAAMC,QAAUH,QAAgC,0BAApBE,EAAME,KAAKC,KAC1C,OAGqB,2DACDC,KAAKJ,EAAMK,UAI7BL,EAAME,KAAKI,YACbC,OAAOC,QAAQC,YAAY,CAAEC,SAAU,iBAAkBC,KAAMX,EAAME,KAAKI,cAAe,SAAUM,IAChF,IAAbA,GAIFd,OAAOe,YAAY,CAAEV,KAAM,2BAA4BG,YAAaM,GAAYZ,EAAMK,OAE1F,IAGAP,OAAOe,YAAY,CAAEV,KAAM,2BAA4BG,iBAAaQ,GAAad,EAAMK,QAE3F,IAAG,GAECP,QAAUA,OAAOiB,gBACnBjB,OAAOiB,eAAeC,QAAQ,oBAAqB,O,CAErD,MAAOC,G","file":"\\nucleus\\nucleus.js","sourcesContent":["'use strict';\r\n\r\ntry {\r\n  window.addEventListener(\"message\", function (event) {\r\n    if ((event.source != window) || (event.data.type !== 'NUCLEUS_FORCE_REFRESH')) {\r\n      return;\r\n    }\r\n\r\n    let domainCheckRegEx = /^https:\\/\\/[^\\/\\.]+\\.(sharepoint|sharepoint\\-df)\\.com$/gm;\r\n    if (!domainCheckRegEx.test(event.origin)) {\r\n      return;\r\n    }\r\n\r\n    if (event.data.messageData) {\r\n      chrome.runtime.sendMessage({ activity: 'nucleusMessage', body: event.data.messageData }, function (response) {\r\n        if (response === true) {\r\n          // Do nothing, this is just telling us the async call is ongoing.\r\n        } else {\r\n          // Pass it on to the postMessage so the web page can act.\r\n          window.postMessage({ type: 'NUCLEUS_REFRESH_COMPLETE', messageData: response }, event.origin);\r\n        }\r\n      });\r\n    } else {\r\n      // We didn't get any message data from website, bail out.\r\n      window.postMessage({ type: 'NUCLEUS_REFRESH_COMPLETE', messageData: undefined }, event.origin);\r\n    }\r\n  }, true);\r\n\r\n  if (window && window.sessionStorage) {\r\n    window.sessionStorage.setItem('nucleus.installed', 'true');\r\n  }\r\n} catch (e) {\r\n  // Swallow, so we don't affect the browser.\r\n}\r\n"],"sourceRoot":""}