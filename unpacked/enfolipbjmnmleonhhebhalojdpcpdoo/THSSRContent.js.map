{"version":3,"sources":["webpack://ScreenShotReader/webpack/universalModuleDefinition","webpack://ScreenShotReader/webpack/bootstrap","webpack://ScreenShotReader/./src/SSRContent.js"],"names":["SSRContent","constructor","croppedImage","ssrData","ssrText","offsetter","_divWrapper","mouseDown","stopSpeaking","paused","startPosition","_rectToOCR","regionIndex","sentenceIndex","_imageProcessor","handler","handleEvents","bind","speechSettings","speechServerURL","voice","speed","user","initialise","chrome","extension","onRequest","addListener","onMessage","runtime","request","sender","sendResponse","alert","fileData","window","addEventListener","stopScreenShotReader","startCapture","document","getElementById","_body","getElementsByTagName","createElement","_divTop","_divRight","_divBottom","_divLeft","_divCenter","_divTopRight","_divClose","_divActions","_divPlay","_divPause","_divStop","_divCopy","_canv","id","_ctx","getContext","width","height","innerHTML","appendChild","updateScreenMaskingElement","getDocumentDimension","Math","max","body","scrollHeight","documentElement","clientHeight","scrollWidth","clientWidth","maskingElement","docClientSize","setStyle","elementToStyle","propertyName","propertyValue","style","setProperty","onMouseDown","mouseDownEvt","x","pageX","y","pageY","ratio","devicePixelRatio","offsetY","offsetX","onMouseUp","mouseUpEvt","stopPropagation","preventDefault","removeEventListener","removeBackgroundColorMaskElements","abs","clientX","clientY","readScreenArea","progressElem","visibility","setMaskPassthrough","releaseCapture","onMouseMove","mouseMoveEvt","w","h","pageYOffset","pageXOffset","drawOCRMask","evt","which","type","rectToOCR","updateCorners","updateCenter","topDiv","rightDiv","bottomDiv","leftDiv","topDivWidth","topDivHeight","rightDivWidth","rightDivHeight","bottomDivWidth","bottomDivHeight","leftDivWidth","leftDivHeight","left","top","centerElem","updateCanvasDimensions","setAttribute","spinner","stopPlaybackAnimation","canvas","animationContext","clearRect","parentNode","removeChild","msg","command","sendMessage","response","sendOCRMessage","roundedRect","ctx","radius","beginPath","moveTo","lineTo","quadraticCurveTo","fill","rightRoundedRect","leftRoundedRect","squareRect","paintFrame","ocrData","wordIndex","words","length","scaleText","hiliteWordRects","rects","fillStyle","bottom","right","lastRight","rectIndex","wordHilitePadding","drawImage","grabbedImage","cropParameters","image","Image","onload","src","showClose","copy","playAgain","stop","pause","copyTextToClipboard","passthrough","pointerEvents","text","copyFrom","textContent","select","execCommand","blur","data","word","JSON","parse","points","actionButtons","display","SSRContentInstance"],"mappings":"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","file":"THSSRContent.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ScreenShotReader\"] = factory();\n\telse\n\t\troot[\"ScreenShotReader\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/SSRContent.js\");\n","export default class SSRContent {\r\n\r\n    constructor() {\r\n\r\n        this.croppedImage = null;\r\n        this.ssrData = null;\r\n        this.ssrText = null;\r\n        this.offsetter;\r\n        this._divWrapper;\r\n        this.mouseDown;\r\n        this.stopSpeaking;\r\n        this.paused;\r\n        this.startPosition = {};\r\n        this._rectToOCR = {};\r\n        this.regionIndex = 0;\r\n        this.sentenceIndex = 0;\r\n        this._imageProcessor = {};\r\n\r\n        //Event Handler\r\n        this.handler = this.handleEvents.bind(this);\r\n\r\n        //Set Defaults if no setting present\r\n        this.speechSettings = {\r\n            speechServerURL: \"https://rwforg.speechstream.net/SpeechServices/index.html\",\r\n            voice: \"Ava?\",\r\n            speed: \"50\",\r\n            user: \"rwforgdocs\"\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Intialise the listener to\r\n     */\r\n    initialise() {\r\n\r\n        chrome.extension.onRequest.addListener(this.onMessage.bind(this));\r\n\r\n        // accept messages from background\r\n        chrome.runtime.onMessage.addListener(function (request, sender, sendResponse) {\r\n            alert(\"Contents Of Text File = \" + request.fileData);\r\n        });\r\n\r\n        // stop screenshot reader on window resize\r\n        window.addEventListener(\"resize\", this.stopScreenShotReader, false);\r\n\r\n    }\r\n\r\n    /**\r\n     * Start the screen capture\r\n     */\r\n    startCapture() {\r\n\r\n        if (!document.getElementById(\"texthelp_ocr_wrapper\")) {\r\n            var _body = document.getElementsByTagName('body')[0];\r\n            var _divWrapper = document.createElement('div');\r\n            var _divTop = document.createElement('div');\r\n            var _divRight = document.createElement('div');\r\n            var _divBottom = document.createElement('div');\r\n            var _divLeft = document.createElement('div');\r\n            var _divCenter = document.createElement('div');\r\n            var _divTopRight = document.createElement('div');\r\n            var _divClose = document.createElement('div');\r\n            var _divActions = document.createElement('div');\r\n            var _divPlay = document.createElement('div');\r\n            var _divPause = document.createElement('div');\r\n            var _divStop = document.createElement('div');\r\n            var _divCopy = document.createElement('div');\r\n            var _canv = document.createElement('canvas');\r\n\r\n            _divWrapper.id = \"texthelp_ocr_wrapper\";\r\n            _divTop.id = \"texthelp_ocr_top\";\r\n            _divRight.id = \"texthelp_ocr_right\";\r\n            _divBottom.id = \"texthelp_ocr_left\";\r\n            _divLeft.id = \"texthelp_ocr_bottom\";\r\n            _divCenter.id = \"texthelp_ocr_center\";\r\n            _divTopRight.id = \"texthelp_ocr_top_right\";\r\n            _divActions.id = \"texthelp_ocr_actions\";\r\n            _divPlay.id = \"texthelp_ocr_play\";\r\n            _divPause.id = \"texthelp_ocr_pause\";\r\n            _divStop.id = \"texthelp_ocr_stop\";\r\n            _divCopy.id = \"texthelp_ocr_copy\";\r\n            _divClose.id = \"texthelp_ocr_close\";\r\n            _canv.id = \"canv\";\r\n            var _ctx = _canv.getContext('2d');\r\n\r\n            _canv.width = 0;\r\n            _canv.height = 0;\r\n\r\n            _divCenter.innerHTML = '<div id=\"thSSRload-bar\" class=\"thSSRload-bar\" style=\"visibility: hidden;\"><div class=\"thSSRbar\"></div><div class=\"thSSRbar\"></div><div class=\"thSSRbar\"></div></div>';\r\n\r\n            _divWrapper.appendChild(_divTop);\r\n            _divWrapper.appendChild(_divRight);\r\n            _divWrapper.appendChild(_divBottom);\r\n            _divWrapper.appendChild(_divLeft);\r\n            _divWrapper.appendChild(_divCenter);\r\n            _divCenter.appendChild(_divClose);\r\n            _divActions.appendChild(_divPlay);\r\n            _divActions.appendChild(_divPause);\r\n            _divActions.appendChild(_divStop);\r\n            _divActions.appendChild(_divCopy);\r\n            _divCenter.appendChild(_divActions);\r\n            _divCenter.appendChild(_canv);\r\n            _body.appendChild(_divWrapper);\r\n\r\n            this.updateScreenMaskingElement(_divWrapper);\r\n\r\n            this._divWrapper = _divWrapper;\r\n\r\n            this._divWrapper.addEventListener(\"mousedown\", this.handler, false);\r\n\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the dimension of the current document taking the largest dimension\r\n     */\r\n    getDocumentDimension() {\r\n        return {\r\n            height: Math.max(document.body.scrollHeight, document.documentElement.clientHeight),\r\n            width: Math.max(document.body.scrollWidth, document.documentElement.clientWidth)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Update the document mask to cover the full screen\r\n     * @param {object} maskingElement \r\n     */\r\n    updateScreenMaskingElement(maskingElement) {\r\n        var docClientSize = this.getDocumentDimension();\r\n        this.setStyle(maskingElement, \"display\", \"none\");\r\n        this.setStyle(maskingElement, \"width\", docClientSize.width + \"px\");\r\n        this.setStyle(maskingElement, \"height\", docClientSize.height + \"px\");\r\n        this.setStyle(maskingElement, \"display\", \"block\");\r\n    }\r\n\r\n    /**\r\n     * Adjust the styles of given element\r\n     * @param {object} elementToStyle Elemeent to style\r\n     * @param {string} propertyName Element style property to adjust\r\n     * @param {string} propertyValue Value to be assigned to the property of the element\r\n     */\r\n    setStyle(elementToStyle, propertyName, propertyValue) {\r\n        elementToStyle.style.setProperty(propertyName, propertyValue)\r\n    }\r\n\r\n    /**\r\n     * Mouse down event handler \r\n     * @param {object} mouseDownEvt mouse down event details\r\n     */\r\n    onMouseDown(mouseDownEvt) {\r\n\r\n        this.startPosition = {\r\n            x: mouseDownEvt.pageX,\r\n            y: mouseDownEvt.pageY,\r\n            ratio: window.devicePixelRatio,\r\n            offsetY: mouseDownEvt.offsetY,\r\n            offsetX: mouseDownEvt.offsetX\r\n        }\r\n\r\n        this._divWrapper.addEventListener(\"mousemove\", this.handler, false);\r\n        this._divWrapper.addEventListener(\"mouseup\", this.handler, false);\r\n\r\n    }\r\n\r\n    /**\r\n     * Mouse up event handler\r\n     * @param {object} mouseUpEvt mouse up event details\r\n     */\r\n    onMouseUp(mouseUpEvt) {\r\n\r\n        mouseUpEvt.stopPropagation();\r\n        mouseUpEvt.preventDefault();\r\n\r\n        this._divWrapper.removeEventListener(\"mousemove\", this.handler, false);\r\n        this._divWrapper.removeEventListener(\"mouseup\", this.handler, false);\r\n        this._divWrapper.removeEventListener(\"mousedown\", this.handler, false);\r\n        this.removeBackgroundColorMaskElements();\r\n\r\n        this.setStyle(this._divWrapper, \"cursor\", \"default\");\r\n\r\n        //Check that capture zone is of a significant size\r\n        if (Math.abs(mouseUpEvt.clientX - this.startPosition.x) > 20 || Math.abs(mouseUpEvt.clientY - this.startPosition.y) > 20) {\r\n\r\n            // Read this area of the screen\r\n            this.readScreenArea(this._rectToOCR);\r\n\r\n            // Display Loading Bar \r\n            var progressElem = document.getElementById('thSSRload-bar');\r\n            if (progressElem !== null) {\r\n                progressElem.style.visibility = 'visible';\r\n            }\r\n\r\n            this.setMaskPassthrough(true);\r\n        }\r\n        else {\r\n            //Area draw not of a significant size reset\r\n            releaseCapture();\r\n            startCapture();\r\n        }\r\n    }\r\n\r\n    /**\r\n    * Mouse move event handler\r\n    * @param {object} mouseMoveEvt \r\n    */\r\n    onMouseMove(mouseMoveEvt) {\r\n\r\n        //Reset wrapper background color\r\n        this.setStyle(this._divWrapper, \"background-color\", \"rgba(0,0,0,0)\");\r\n\r\n        //Calculate the Width and Height\r\n        var w = mouseMoveEvt.pageX - this.startPosition.x;\r\n        var h = mouseMoveEvt.pageY - this.startPosition.y;\r\n\r\n        this._rectToOCR = {\r\n            x: this.startPosition.x,\r\n            y: this.startPosition.y,\r\n            width: w,\r\n            height: h,\r\n            ratio: this.startPosition.ratio,\r\n            pageYOffset: window.pageYOffset,\r\n            pageXOffset: window.pageXOffset,\r\n            speechSettings: this.speechSettings\r\n        }\r\n\r\n        this.drawOCRMask(this._rectToOCR);\r\n\r\n    }\r\n\r\n    /**\r\n     * Event handler\r\n     * @param {object} evt event details\r\n     */\r\n    handleEvents(evt) {\r\n\r\n        this._divWrapper = document.getElementById(\"texthelp_ocr_wrapper\");\r\n\r\n        //Ignore all right clicks\r\n        switch (evt.which) {\r\n            case 3:\r\n            return;\r\n        }\r\n        \r\n        switch (evt.type) {\r\n            case \"mousedown\":\r\n                // code block\r\n                this.onMouseDown(evt);\r\n                break;\r\n            case \"mousemove\":\r\n                // code block\r\n                this.onMouseMove(evt);\r\n                break;\r\n            case \"mouseup\":\r\n                // code block\r\n                this.onMouseUp(evt);\r\n                break;\r\n            default:\r\n            // code block\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Mask the entire screen\r\n     * @param {object} rectToOCR Area to OCR\r\n     */\r\n    drawOCRMask(rectToOCR) {\r\n        this.updateCorners(rectToOCR);\r\n        this.updateCenter(rectToOCR);\r\n    }\r\n\r\n    /**\r\n     * remove the background colouring from the mask\r\n     */\r\n    removeBackgroundColorMaskElements() {\r\n        var topDiv = document.getElementById(\"texthelp_ocr_top\");\r\n        var rightDiv = document.getElementById(\"texthelp_ocr_right\");\r\n        var bottomDiv = document.getElementById(\"texthelp_ocr_bottom\");\r\n        var leftDiv = document.getElementById(\"texthelp_ocr_left\");\r\n\r\n        this.setStyle(topDiv, \"background-color\", \"rgba(0,0,0,0)\");\r\n        this.setStyle(rightDiv, \"background-color\", \"rgba(0,0,0,0)\");\r\n        this.setStyle(bottomDiv, \"background-color\", \"rgba(0,0,0,0)\");\r\n        this.setStyle(leftDiv, \"background-color\", \"rgba(0,0,0,0)\");\r\n    }\r\n\r\n    /**\r\n     * Set the dimensions of the elements framing the center \r\n     * @param {object} rectToOCR Area to OCR and Highlight\r\n     */\r\n    updateCorners(rectToOCR) {\r\n\r\n        var docClientSize = this.getDocumentDimension();\r\n\r\n        //Top\r\n        var topDivWidth = rectToOCR.width >= 0 ? rectToOCR.x + rectToOCR.width : rectToOCR.x;\r\n        var topDivHeight = rectToOCR.height >= 0 ? rectToOCR.y : rectToOCR.y + rectToOCR.height;\r\n\r\n        //Right \r\n        var rightDivWidth = rectToOCR.width >= 0 ? docClientSize.width - rectToOCR.x - rectToOCR.width : docClientSize.width - rectToOCR.x;\r\n        var rightDivHeight = rectToOCR.height >= 0 ? rectToOCR.y + rectToOCR.height : rectToOCR.y;\r\n\r\n        //Bottom\r\n        var bottomDivWidth = rectToOCR.width >= 0 ? docClientSize.width - rectToOCR.x : docClientSize.width - rectToOCR.x - rectToOCR.width;\r\n        var bottomDivHeight = docClientSize.height - rightDivHeight;\r\n\r\n        //Left\r\n        var leftDivWidth = docClientSize.width - bottomDivWidth;\r\n        var leftDivHeight = docClientSize.height - topDivHeight;\r\n\r\n        var topDiv = document.getElementById(\"texthelp_ocr_top\");\r\n        var rightDiv = document.getElementById(\"texthelp_ocr_right\");\r\n        var bottomDiv = document.getElementById(\"texthelp_ocr_bottom\");\r\n        var leftDiv = document.getElementById(\"texthelp_ocr_left\");\r\n\r\n        //Top Div\r\n        this.setStyle(topDiv, \"width\", topDivWidth + \"px\");\r\n        this.setStyle(topDiv, \"height\", topDivHeight + \"px\");\r\n\r\n        //Right Div\r\n        this.setStyle(rightDiv, \"width\", rightDivWidth + \"px\");\r\n        this.setStyle(rightDiv, \"height\", rightDivHeight + \"px\");\r\n\r\n        //Bottom Div\r\n        this.setStyle(bottomDiv, \"width\", bottomDivWidth + \"px\");\r\n        this.setStyle(bottomDiv, \"height\", bottomDivHeight + \"px\");\r\n\r\n        //Left Div\r\n        this.setStyle(leftDiv, \"width\", leftDivWidth + \"px\");\r\n        this.setStyle(leftDiv, \"height\", leftDivHeight + \"px\");\r\n    }\r\n\r\n    /**\r\n     * Set the dimensions of the center masking element\r\n     * @param {object} rectToOCR Area to OCR and Highlight\r\n     */\r\n    updateCenter(rectToOCR) {\r\n\r\n        var left = rectToOCR.width >= 0 ? rectToOCR.x : rectToOCR.x + rectToOCR.width;\r\n        var top = rectToOCR.height >= 0 ? rectToOCR.y : rectToOCR.y + rectToOCR.height;\r\n        var centerElem = document.getElementById(\"texthelp_ocr_center\");\r\n\r\n        this.setStyle(centerElem, \"width\", Math.abs(rectToOCR.width) + \"px\");\r\n        this.setStyle(centerElem, \"height\", Math.abs(rectToOCR.height) + \"px\");\r\n        this.setStyle(centerElem, \"top\", top + \"px\");\r\n        this.setStyle(centerElem, \"left\", left + \"px\");\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {*} width \r\n     * @param {*} height \r\n     */\r\n    updateCanvasDimensions(width, height) {\r\n        document.getElementById('canv').setAttribute('width', Math.abs(width) + \"px\")\r\n        document.getElementById('canv').setAttribute('height', Math.abs(height) + \"px\");\r\n    }\r\n\r\n    /**\r\n     * Stop screenshot capture, release the mask and stop speech\r\n     */\r\n    stopScreenShotReader() {\r\n\r\n        if (this.releaseCapture == null) {\r\n            return;\r\n        }\r\n\r\n        this.releaseCapture();\r\n\r\n        this.stopSpeaking = false;\r\n\r\n        var spinner = document.getElementById(\"thSSRload-bar\");\r\n        if (spinner != null) {\r\n            spinner.style.visibility = 'hidden';\r\n\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Stop the playback animation\r\n     */\r\n    stopPlaybackAnimation() {\r\n\r\n        var canvas = document.getElementById('canv');\r\n        var animationContext = canvas.getContext(\"2d\");\r\n\r\n        if (animationContext != null) {\r\n            animationContext.clearRect(0, 0, this._rectToOCR.width * window.devicePixelRatio, this._rectToOCR.height * window.devicePixelRatio);\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * Release the capture wrapper / reset \r\n     */\r\n    releaseCapture() {\r\n\r\n        this.paused = false;\r\n\r\n        var _divWrapper = document.getElementById(\"texthelp_ocr_wrapper\");\r\n\r\n        if (_divWrapper == null) {\r\n            return;\r\n        }\r\n\r\n        _divWrapper.parentNode.removeChild(_divWrapper);\r\n\r\n\r\n        this.stopSpeaking = true;\r\n        //stop speech\r\n        var msg = { command: 'stop' };\r\n\r\n        chrome.runtime.sendMessage(msg, function (response) { });\r\n    }\r\n\r\n    /**\r\n     * Send the area to be read to the background\r\n     * @param {object} rectToOCR  Area to OCR and Highlight\r\n     */\r\n    readScreenArea(rectToOCR) {\r\n\r\n        //Send the message to the background\r\n        this.sendOCRMessage(rectToOCR);\r\n    }\r\n\r\n    /**\r\n     * Draw the Rect to Screen\r\n     * @param {*} ctx canvas context\r\n     * @param {*} x  x position \r\n     * @param {*} y  y position \r\n     * @param {*} width width of selection \r\n     * @param {*} height height of selection \r\n     * @param {*} radius radius of corners\r\n     */\r\n    roundedRect(ctx, x, y, width, height, radius) {\r\n        ctx.beginPath();\r\n\r\n        // bottom left corner\r\n        ctx.moveTo(x, y + radius);\r\n        ctx.lineTo(x, y + height - radius);\r\n        ctx.quadraticCurveTo(x, y + height, x + radius, y + height);\r\n\r\n        //bottom right\r\n        ctx.lineTo(x + width - radius, y + height);\r\n        ctx.quadraticCurveTo(x + width, y + height, x + width, y + height - radius);\r\n\r\n        // top right\r\n        ctx.lineTo(x + width, y + radius);\r\n        ctx.quadraticCurveTo(x + width, y, x + width - radius, y);\r\n\r\n        //top left\r\n        ctx.lineTo(x + radius, y);\r\n        ctx.quadraticCurveTo(x, y, x, y + radius);\r\n        ctx.fill();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {*} ctx canvas context\r\n     * @param {*} x  x position \r\n     * @param {*} y  y position \r\n     * @param {*} width width of selection \r\n     * @param {*} height height of selection \r\n     * @param {*} radius radius of corners\r\n     */\r\n    rightRoundedRect(ctx, x, y, width, height, radius) {\r\n        ctx.beginPath();\r\n\r\n        // bottom left corner\r\n        ctx.moveTo(x, y);\r\n        ctx.lineTo(x, y + height);\r\n\r\n        //bottom right\r\n        ctx.lineTo(x + width - radius, y + height);\r\n        ctx.quadraticCurveTo(x + width, y + height, x + width, y + height - radius);\r\n\r\n        // top right\r\n        ctx.lineTo(x + width, y + radius);\r\n        ctx.quadraticCurveTo(x + width, y, x + width - radius, y);\r\n\r\n        //top left\r\n        ctx.lineTo(x, y);\r\n        ctx.fill();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {*} ctx canvas context\r\n     * @param {*} x  x position \r\n     * @param {*} y  y position \r\n     * @param {*} width width of selection \r\n     * @param {*} height height of selection \r\n     * @param {*} radius radius of corners\r\n     */\r\n    leftRoundedRect(ctx, x, y, width, height, radius) {\r\n        ctx.beginPath();\r\n\r\n        // bottom left corner\r\n        ctx.moveTo(x, y + radius);\r\n        ctx.lineTo(x, y + height - radius);\r\n        ctx.quadraticCurveTo(x, y + height, x + radius, y + height);\r\n\r\n        //bottom right\r\n        ctx.lineTo(x + width, y + height);\r\n\r\n        // top right\r\n        ctx.lineTo(x + width, y);\r\n\r\n        //top left\r\n        ctx.lineTo(x + radius, y);\r\n        ctx.quadraticCurveTo(x, y, x, y + radius);\r\n        ctx.fill();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {*} ctx canvas context\r\n     * @param {*} x  x position \r\n     * @param {*} y  y position \r\n     * @param {*} width width of selection \r\n     * @param {*} height height of selection \r\n     * @param {*} radius radius of corners\r\n     */\r\n    squareRect(ctx, x, y, width, height, radius) {\r\n        ctx.beginPath();\r\n\r\n        // bottom left corner\r\n        ctx.moveTo(x, y);\r\n        ctx.lineTo(x, y + height);\r\n\r\n        //bottom right\r\n        ctx.lineTo(x + width, y + height);\r\n\r\n        // top right\r\n        ctx.lineTo(x + width, y);\r\n\r\n        //top left\r\n        ctx.lineTo(x, y);\r\n\r\n        ctx.fill();\r\n    }\r\n\r\n    /**\r\n     * Draw frame to screen highlighting current spoken word\r\n     * @param {*} ocrData \r\n     * @param {*} wordIndex \r\n     */\r\n    paintFrame(ocrData, wordIndex) {\r\n\r\n        if (wordIndex >= this.ssrData[this.regionIndex][this.sentenceIndex].words.length) {\r\n            return;\r\n        }\r\n\r\n        var scaleText = window.devicePixelRatio;\r\n        var hiliteWordRects = this.ssrData[this.regionIndex][this.sentenceIndex].words[wordIndex].rects;\r\n\r\n        // get the canvas element using the DOM\r\n        var canvas = document.getElementById('canv');\r\n\r\n        this.updateCanvasDimensions(this._rectToOCR.width, this._rectToOCR.height);\r\n\r\n        var animationContext = canvas.getContext(\"2d\");\r\n\r\n        //animationContext.drawImage(this.croppedImage, 0, 0, this._rectToOCR.width, this._rectToOCR.height);\r\n        //   animationContext.clearRect(0, 0, cropWidth, cropHeight);\r\n\r\n        animationContext.fillStyle = 'rgba(0,0,255,0.25)';\r\n        // if there is only one rect then highlight with rounded corners.\r\n        if (hiliteWordRects.length == 1) {\r\n\r\n            this.roundedRect(animationContext,\r\n                ((hiliteWordRects[0].bottom / scaleText) + 0.5),\r\n                ((hiliteWordRects[0].top / scaleText) + 0.5),\r\n                (((hiliteWordRects[0].left) / scaleText) - 0.5),\r\n                (((hiliteWordRects[0].right / scaleText) + 0.5)), 5);\r\n\r\n            var lastRight = 0;\r\n\r\n            return;\r\n        }\r\n\r\n        // else do rounding at either ends\r\n        var rectIndex = 0;\r\n        for (rectIndex = 0; rectIndex < hiliteWordRects.length; rectIndex++) {\r\n\r\n            // if first rect left corners should be rounded\r\n\r\n            if (rectIndex == 0) {\r\n\r\n                this.leftRoundedRect(animationContext,\r\n                    ((hiliteWordRects[rectIndex].left / scaleText) + 0.5) - (wordHilitePadding),\r\n                    ((hiliteWordRects[rectIndex].top / scaleText) + 0.5) - (wordHilitePadding * 2),\r\n                    (((hiliteWordRects[rectIndex].right - hiliteWordRects[rectIndex].left) / scaleText) + 0.5)/* + (wordHilitePadding * 2)*/,\r\n                    (((hiliteWordRects[rectIndex].bottom - hiliteWordRects[rectIndex].top) / scaleText) + 0.5) + (wordHilitePadding * 2), 5);\r\n\r\n                lastRight = (((hiliteWordRects[rectIndex].left / scaleText) + 0.5) - (wordHilitePadding)) +\r\n                    (((hiliteWordRects[rectIndex].right - hiliteWordRects[rectIndex].left) / scaleText) + 0.5);\r\n            }\r\n            else if (rectIndex == hiliteWordRects.length - 1) {\r\n                //if last rect right corners should be round\r\n                this.rightRoundedRect(animationContext,\r\n                    /*   ((hiliteWordRects[rectIndex].left / scaleText) + 0.5) - (wordHilitePadding),*/\r\n                    lastRight,       //(((hiliteWordRects[rectIndex - 1].right) / scaleText) + 0.5),\r\n                    ((hiliteWordRects[rectIndex].top / scaleText) + 0.5) - (wordHilitePadding * 2),\r\n                    (((hiliteWordRects[rectIndex].right - hiliteWordRects[rectIndex].left) / scaleText) + 0.5) + (wordHilitePadding * 2),\r\n                    (((hiliteWordRects[rectIndex].bottom - hiliteWordRects[rectIndex].top) / scaleText) + 0.5) + (wordHilitePadding * 2), 5);\r\n\r\n                lastRight = 0;\r\n            }\r\n            else {\r\n                // in the middle so no rounded rects\r\n                this.squareRect(animationContext,\r\n                    //  ((hiliteWordRects[rectIndex].left / scaleText) + 0.5) - (wordHilitePadding),\r\n                    lastRight,           // (((hiliteWordRects[rectIndex - 1].right) / scaleText) + 0.5),\r\n                    ((hiliteWordRects[rectIndex].top / scaleText) + 0.5) - (wordHilitePadding * 2),\r\n                    (((hiliteWordRects[rectIndex].right - hiliteWordRects[rectIndex].left) / scaleText) + 0.5)/* + (wordHilitePadding * 2)*/,\r\n                    (((hiliteWordRects[rectIndex].bottom - hiliteWordRects[rectIndex].top) / scaleText) + 0.5) + (wordHilitePadding * 2), 5);\r\n\r\n                lastRight = lastRight + (((hiliteWordRects[rectIndex].right - hiliteWordRects[rectIndex].left) / scaleText) + 0.5);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    drawImage(grabbedImage, cropParameters) {\r\n\r\n        var canvas = document.getElementById(\"canv\");\r\n        var ctx = canvas.getContext(\"2d\");\r\n\r\n        var image = new Image();\r\n        image.onload = function () {\r\n            ctx.drawImage(image, 0, 0);\r\n        };\r\n\r\n        image.src = grabbedImage;\r\n\r\n        this.showClose();\r\n\r\n        //Hide Loading Bar\r\n        var progressElem = document.getElementById('thSSRload-bar');\r\n        if (progressElem !== null) {\r\n            progressElem.style.visibility = 'hidden';\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Show the close button and add event listeners\r\n     */\r\n    showClose() {\r\n        this.setStyle(document.getElementById(\"texthelp_ocr_close\"), \"display\", \"block\");\r\n        document.getElementById(\"texthelp_ocr_close\").addEventListener(\"mousedown\", this.releaseCapture.bind(this), false);\r\n        document.getElementById(\"texthelp_ocr_copy\").addEventListener(\"mousedown\", this.copy.bind(this), false);\r\n        document.getElementById(\"texthelp_ocr_play\").addEventListener(\"mousedown\", this.playAgain.bind(this), false);\r\n        document.getElementById(\"texthelp_ocr_stop\").addEventListener(\"mousedown\", this.stop.bind(this), false);\r\n        document.getElementById(\"texthelp_ocr_pause\").addEventListener(\"mousedown\", this.pause.bind(this), false);\r\n\r\n    }\r\n\r\n    /**\r\n    * Send the current selection text to the clipboard\r\n    */\r\n    copy() {\r\n        this.copyTextToClipboard(this.ssrText);\r\n    }\r\n\r\n    /**\r\n    * Play the selected Passage Again from the start \r\n    */\r\n    playAgain() {\r\n\r\n\r\n\r\n        if(this.paused){\r\n        //Play Message Command\r\n        var msg = { command: 'pause' };\r\n        chrome.runtime.sendMessage(msg, function (response) { });\r\n        }\r\n        else{\r\n\r\n        //Ensure no speech is currently reading\r\n        var msg = { command: 'stop' };\r\n        chrome.runtime.sendMessage(msg, function (response) { });\r\n\r\n        //Reset the Canvas\r\n        this.stopPlaybackAnimation();\r\n        \r\n        //Play Message Command  \r\n        var msg = { command: 'TH_Play_Again_SSR' };\r\n        chrome.runtime.sendMessage(msg, function (response) { });\r\n        }\r\n\r\n        this.paused = false;\r\n    }\r\n\r\n    /**\r\n    * Stop the selected passage \r\n    */\r\n    stop() {\r\n\r\n        this.paused = false;\r\n\r\n        //Play Message Command\r\n        var msg = { command: 'stop' };\r\n        chrome.runtime.sendMessage(msg, function (response) { });\r\n\r\n        //Reset the Canvas\r\n        this.stopPlaybackAnimation();\r\n\r\n    }\r\n\r\n    /**\r\n    * Pause the selected passage  \r\n    */\r\n    pause() {\r\n\r\n        this.paused = true;\r\n\r\n        //Pause Message Command\r\n        var msg = { command: 'pause' };\r\n        chrome.runtime.sendMessage(msg, function (response) { });\r\n    }\r\n\r\n    /**\r\n     * Set mask passthrough\r\n     * @param {*} passthrough \r\n     */\r\n    setMaskPassthrough(passthrough) {\r\n        var _divWrapper = document.getElementById('texthelp_ocr_wrapper');\r\n        var _divTop = document.getElementById('texthelp_ocr_top');\r\n        var _divRight = document.getElementById('texthelp_ocr_right');\r\n        var _divBottom = document.getElementById('texthelp_ocr_bottom');\r\n        var _divLeft = document.getElementById('texthelp_ocr_left');\r\n        var _divCenter = document.getElementById('texthelp_ocr_center');\r\n\r\n        var pointerEvents = 'all';\r\n        if (passthrough) {\r\n            pointerEvents = 'none';\r\n        }\r\n\r\n        if (_divWrapper != null) {\r\n            _divWrapper.style.pointerEvents = pointerEvents;\r\n        }\r\n\r\n        if (_divTop != null) {\r\n            _divTop.style.pointerEvents = pointerEvents;\r\n        }\r\n\r\n        if (_divRight != null) {\r\n            _divRight.style.pointerEvents = pointerEvents;\r\n        }\r\n\r\n        if (_divBottom != null) {\r\n            _divBottom.style.pointerEvents = pointerEvents;\r\n        }\r\n\r\n        if (_divLeft != null) {\r\n            _divLeft.style.pointerEvents = pointerEvents;\r\n        }\r\n\r\n        if (_divCenter != null) {\r\n            _divCenter.style.pointerEvents = 'all';\r\n        }\r\n\r\n\r\n    }\r\n\r\n    /**\r\n    * Copy the sent text to the clipboard\r\n    * @param {string} text Text to copy to the clipboard\r\n    */\r\n    copyTextToClipboard(text) {\r\n        //Create a textbox field where we can insert text to. \r\n        var copyFrom = document.createElement(\"textarea\");\r\n\r\n        //Set the text content to be the text you wished to copy.\r\n        copyFrom.textContent = text;\r\n\r\n        //Append the textbox field into the body as a child. \r\n        //\"execCommand()\" only works when there exists selected text, and the text is inside \r\n        //document.body (meaning the text is part of a valid rendered HTML element).\r\n        document.body.appendChild(copyFrom);\r\n\r\n        //Select all the text!\r\n        copyFrom.select();\r\n\r\n        //Execute command\r\n        document.execCommand('copy');\r\n\r\n        //(Optional) De-select the text using blur(). \r\n        copyFrom.blur();\r\n\r\n        //Remove the textbox field from the document.body, so no other JavaScript nor \r\n        //other elements can get access to this.\r\n        document.body.removeChild(copyFrom);\r\n    }\r\n\r\n    /**\r\n     * Send a message to the positions of the screen selection to the background\r\n     * @param {object} rectToOCR Area to OCR and Highlight\r\n     */\r\n    sendOCRMessage(rectToOCR) {\r\n        chrome.runtime.sendMessage({ rectToOCR: rectToOCR, command: \"TH_rectToOCR_SSR\" }, function (response) {\r\n            //console.log(response);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {object} request message request object \r\n     * @param {} sender sender / id of the sender of the request\r\n     * @param {*} sendResponse loaction to send a responce \r\n     */\r\n    onMessage(request, sender, sendResponse) {\r\n\r\n        switch (request.command) {\r\n            case \"startScreenShotReader\":\r\n            case \"TH_SSR_Start_Capture\":\r\n\r\n                //Speech Settings \r\n                this.speechSettings = request;\r\n\r\n                //Release previous captures\r\n                this.stopScreenShotReader();\r\n\r\n                // Start Capture\r\n                this.startCapture();\r\n\r\n                break;\r\n            case \"TH_onWord_SSR\":\r\n                this.regionIndex = request.data.regionIndex;\r\n                this.sentenceIndex = request.data.sentenceIndex;\r\n                this.paintFrame(this.ssrData, request.data.word);\r\n                break;\r\n            case \"TH_onStop_SSR\":\r\n                this.stopPlaybackAnimation();\r\n                break;\r\n            case \"TH_onOCR_SSR\":\r\n                //console.log(request.data);\r\n                this.ssrData = JSON.parse(request.data);\r\n                this.drawImage(request.image, request.points);\r\n                this.croppedImage = request.image;\r\n\r\n                var actionButtons = document.getElementById('texthelp_ocr_actions');\r\n                actionButtons.style.display = 'block';\r\n\r\n                this.ssrText = request.text;\r\n                break;\r\n            default:\r\n            // code block\r\n        }\r\n\r\n\r\n\r\n    }\r\n\r\n}\r\n\r\nconst SSRContentInstance = new SSRContent();\r\nSSRContentInstance.initialise();"],"sourceRoot":""}